apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - projects.yaml
  # Critical applications with specific sync waves to prevent race conditions
  # Wave 0: Foundation components (networking + secrets infrastructure)
  - argocd-control-plane.yaml
  - cilium-app.yaml              # Wave 0 - Networking foundation
  - 1passwordconnect.yaml        # Wave 0 - Secret Backend (required by external secrets)
  - external-secrets.yaml        # Wave 0 - External Secrets CRDs (required by proxmox storage driver)
  - csi-driver-proxmox-app.yaml  # Wave 1 - Storage foundation
  - longhorn-app.yaml            # Wave 1 - Storage foundation
  - snapshot-controller-app.yaml # Wave 1 - VolumeSnapshot controller + CRDs
  # ApplicationSets
  - infrastructure-appset.yaml   # Wave 2
  - monitoring-appset.yaml       # Wave 3
  - my-apps-appset.yaml          # Wave 4
